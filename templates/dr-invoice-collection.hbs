<html>
  <head>
    <meta charset="utf-8" />
    <title>Dr Invoice Collection</title>
    {{> reset}}
    {{> invoiceStyle}}
    <style>
      .page-break {
        page-break-before: always;
      }
      #summary header h1 {
        margin: 0;
      }
      #summary table {
        width: 100%;
        border-collapse: collapse;
      }
      #summary th,
      #summary td {
        border-bottom: 1px solid #ddd;
        padding: 6px;
        text-align: left;
      }
      #summary thead th {
        font-weight: 700;
      }
      #summary tbody td:first-child {
        font-weight: 700;
      }
      #summary tfoot td {
        font-weight: bold;
      }
      #adjustments__items {
        display: grid;
        grid-row-gap: 6px;
        margin-top: 8px;
      }
      .adjustments__items__item {
        display: grid;
        grid-template-columns: 80px 1fr 160px;
      }
      .right {
        text-align: right;
      }
      /* Make summary amount due larger and centered compared to normal */
      #summary #grand-total {
        width: 80%;
        margin: 2rem auto 0;
        text-align: center;
      }
      #summary #grand-total > *:first-child {
        font-size: 2rem;
      }
      #summary #grand-total > *:last-child {
        font-size: 3rem;
      }
    </style>
  </head>
  <body id="dr-body">
    <main>
      <section id="summary">
        <header id="header">
          <div id="header-top">
            <div id="header-top-title">
              {{#if @root.logoSrc}}
              <img
                id="header-logo"
                src="{{@root.logoSrc}}"
                alt="CHI Global Network logo"
              />
              {{/if}}
              <div id="header-top-text">
                <h1>Summary</h1>
                <h2>Dr's Secret</h2>
              </div>
            </div>
            <div id="header-top-number">Collection #{{ collection.id }}</div>
          </div>
          <div id="header-info">
            <div>
              <div class="value-display">
                <div class="label">DATE</div>
                <div class="value">{{ collection.date }}</div>
              </div>
              {{#if collection.note}}
              <div class="value-display">
                <div class="label">NOTE</div>
                <div class="value">{{ collection.note }}</div>
              </div>
              {{/if}}
            </div>
          </div>
        </header>

        <article>
          <h3>Invoices</h3>
          <table>
            <thead>
              <tr>
                <th>Invoice</th>
                <th>Date</th>
                <th class="right">Total (Rp)</th>
              </tr>
            </thead>
            <tbody>
              {{#each collection.DrInvoices}}
              <tr>
                <td>#{{ this.id }}</td>
                <td>{{ this.date }}</td>
                <td class="right">{{formatRP this.totalPriceRP}}</td>
              </tr>
              {{/each}}
            </tbody>
            <tfoot>
              <tr>
                <td colspan="2">Total Invoices</td>
                <td class="right">{{formatRP collection.totalInvoicesRP}}</td>
              </tr>
            </tfoot>
          </table>
        </article>

        {{#if collection.DrInvoiceCollectionAdjustments}}
        <article id="adjustments">
          <div id="adjustments__title">Adjustments</div>
          <div id="adjustments__items">
            {{#each collection.DrInvoiceCollectionAdjustments}}
            <div class="adjustments__items__item">
              <div>{{ this.date }}</div>
              <div>{{ this.description }}</div>
              <div class="right">{{formatRP this.amount}}</div>
            </div>
            {{/each}}
          </div>
        </article>
        {{/if}}

        <footer>
          <article id="grand-total">
            <div>AMOUNT DUE</div>
            <div>{{formatRP collection.grandTotalRP}}</div>
          </article>
        </footer>
      </section>

      {{#each collection.DrInvoices}}
      <div class="page-break"></div>
      {{> dr-invoice-body invoice=this}}
      {{/each}}
    </main>
  </body>
</html>
